{% extends "ppatrigger/base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
  <div class="panel panel-default">
    <div class="panel-body">

      {% if error_message %}
        <div class="alert alert-danger">
          <strong>Project not added</strong> {{ error_message }}
        </div>
      {% endif %}

      <table class="table table-striped">
        <tr>
          <th>Project</th>
          <th>Branch</th>
          <th>Commit</th>
          <th>Built with</th>
          <th>Status</th>
          <th></th>
          <th></th>
        </tr>
        {% for project in projects %}
          <tr>
            <td>{{ project.username }}/{{ project.repository }}</td>
            <td>{{ project.branch }}</td>
            <td>{{ project.last_build.commit }}</td>
            <td>{{ project.last_build.package_version }}</td>
            <td>
              {% if not project.last_triggered %}
                Awaiting first build
              {% elif project.build_requested or project.build_started %}
                <img src="/static/gfx/spinner.png" alt="building"/>
              {% elif project.last_build.status == 0 %}
                <img src="/static/gfx/passing.png" alt="passing build"/>
              {% elif project.last_build.status > 0 %}
                <img src="/static/gfx/failing.png" alt="failing build"/>
              {% else %}
                <img src="/static/gfx/unknown.png" alt="unknown build"/>
              {% endif %}
            </td>
            <td>
              {% if project.last_build %}
                <a href="https://travis-ci.org/{{ project.usernameÂ }}/{{project.repository}}/builds/{{ project.last_build.build_id }}">build log</a>
              {% endif %}
            </td>
            <td>
              {% if project.last_build %}
                <a href="{% url 'show_project' project.id %}">details</a></td>
              {% endif %}
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>
{% endblock %}

